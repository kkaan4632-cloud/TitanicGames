<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Titanik Parçalama Oyunu</title>
<style>
  body { margin:0; background: #111; color: white; font-family: Arial; overflow: hidden; }
  canvas { display: block; margin: auto; touch-action: none; border: 2px solid white; }
  #controls { padding: 10px; text-align: center; }
  button { margin: 5px; padding: 10px; font-size: 16px; border-radius: 8px; cursor: pointer; }
  #score { font-size: 18px; margin: 10px; text-align: center; }
  footer { text-align: center; margin-top: 10px; font-size: 14px; color: #bbb; }
</style>
</head>
<body>
<h1 style="text-align:center;">🚢 Titanic Parçalama Oyunu</h1>
<div id="controls">
<button onclick="setMode('patlat')">💥 Patlat</button>
<button onclick="setMode('kes')">✂️ Kes</button>
<button onclick="setMode('del')">🕳️ Delik Aç</button>
<button onclick="setMode('lazer')">🔫 Lazer</button>
<button onclick="setMode('atom')">☢️ Atom Bombası</button>
<button onclick="sinkShip()">🌊 Batır</button>
<button onclick="repairShip()">🔧 Onar</button>
</div>
<div id="score">Skor: 0</div>
<canvas id="gameCanvas" width="800" height="450"></canvas>
<footer>ADABAŞI İHO ÖĞRENCİSİ TARAFINDAN YAPILMIŞTIR – TELİF HAKLARI <b>KORAY KAAN KARTAL</b>’A AİTTİR VE <b>EMİR</b>’İN EMEĞİ VARDIR</footer>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let damages = [];
let mode = "patlat";
let score = 0;
let shipY = 200;
let sinking = false;
let waterOffset = 0;
let shipPieces = [{x:200, y:200, w:400, h:100, vx:0, vy:0, broken:false}];

const shipImg = new Image();
shipImg.src = "https://i.ibb.co/2qV6S3L/titanic.png";

// Kontrol seçimi
function setMode(m){ mode=m; }

// Pozisyon alma (dokunmatik + fare)
function getPos(e){
  const rect=canvas.getBoundingClientRect();
  if(e.touches) return {x:e.touches[0].clientX-rect.left, y:e.touches[0].clientY-rect.top};
  return {x:e.clientX-rect.left, y:e.clientY-rect.top};
}

// Saldırı uygulama
function attack(x,y){
  if(sinking) return;
  damages.push({type:mode, x:x, y:y});
  score += (mode==="atom")?10:1;
  document.getElementById("score").innerText="Skor: "+score;

  if(mode==="atom"){
    for(let i=0;i<15;i++){
      damages.push({type:"patlat", x:x+Math.random()*200-100, y:y+Math.random()*100-50});
    }
    shipPieces.forEach(p=>p.broken=true);
  } else if(mode==="kes"){
    shipPieces.forEach(p=>{
      if(!p.broken && x>p.x && x<p.x+p.w && y>p.y && y<p.y+p.h){
        p.broken=true;
        p.vx=(Math.random()*4-2);
        p.vy=(Math.random()*-3);
      }
    });
  }
  drawScene();
}

canvas.addEventListener("click", e=>attack(getPos(e).x,getPos(e).y));
canvas.addEventListener("touchstart", e=>{ e.preventDefault(); attack(getPos(e).x,getPos(e).y); });

// Çizim fonksiyonu
function drawScene(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Gökyüzü
  ctx.fillStyle="#0b0b30";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // Dalgalı deniz
  ctx.fillStyle="#1e90ff";
  ctx.beginPath();
  ctx.moveTo(0, canvas.height*0.7);
  for(let i=0;i<=canvas.width;i++){
    ctx.lineTo(i, canvas.height*0.7 + Math.sin((i+waterOffset)/20)*10);
  }
  ctx.lineTo(canvas.width, canvas.height);
  ctx.lineTo(0, canvas.height);
  ctx.closePath();
  ctx.fill();
  waterOffset += 1;

  // Gemi parçaları
  shipPieces.forEach(p=>{
    if(p.broken){
      p.vy +=0.1; // yerçekimi
      p.y+=p.vy;
      p.x+=p.vx;
    }
    ctx.drawImage(shipImg, p.x, p.y, p.w, p.h);
  });

  // Hasar efektleri
  damages.forEach(d=>{
    if(d.type==="patlat"){
      ctx.beginPath();
      ctx.arc(d.x,d.y,20,0,Math.PI*2);
      ctx.fillStyle="red";
      ctx.fill();
      ctx.strokeStyle="yellow";
      ctx.stroke();
    }
    else if(d.type==="kes"){
      ctx.beginPath();
      ctx.moveTo(d.x-50,d.y-50);
      ctx.lineTo(d.x+50,d.y+50);
      ctx.strokeStyle="white";
      ctx.lineWidth=3;
      ctx.stroke();
    }
    else if(d.type==="del"){
      ctx.beginPath();
      ctx.arc(d.x,d.y,12,0,Math.PI*2);
      ctx.fillStyle="black";
      ctx.fill();
    }
    else if(d.type==="lazer"){
      ctx.beginPath();
      ctx.moveTo(d.x,0);
      ctx.lineTo(d.x,canvas.height);
      ctx.strokeStyle="lime";
      ctx.lineWidth=3;
      ctx.stroke();
    }
    else if(d.type==="atom"){
      ctx.beginPath();
      ctx.arc(d.x,d.y,30,0,Math.PI*2);
      ctx.fillStyle="orange";
      ctx.fill();
      ctx.strokeStyle="red";
      ctx.stroke();
      // Ekran sallama
      const shakeX=Math.random()*6-3;
      const shakeY=Math.random()*6-3;
      ctx.translate(shakeX,shakeY);
      setTimeout(()=>{ctx.setTransform(1,0,0,1,0,0);},50);
    }
  });
}

// Onar butonu
function repairShip(){
  damages=[];
  score=0;
  shipY=200;
  sinking=false;
  shipPieces=[{x:200, y:200, w:400, h:100, vx:0, vy:0, broken:false}];
  document.getElementById("score").innerText="Skor: 0";
  drawScene();
}

// Batırma animasyonu
function sinkShip(){
  if(sinking) return;
  sinking=true;
  const sinkInterval=setInterval(()=>{
    shipPieces.forEach(p=>p.y+=3);
    drawScene();
    if(shipPieces.every(p=>p.y>canvas.height)){clearInterval(sinkInterval);}
  },60);
}

// Ana animasyon
function animate(){
  drawScene();
  requestAnimationFrame(animate);
}
animate();
</script>
</body>
</html>
